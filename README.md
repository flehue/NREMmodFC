# NREMmodFC
Wilson-Cowan implementation for the testing of NA and ACh NREM-FC modulation hypotheses.

https://www.biorxiv.org/content/10.1101/2025.02.06.636812v1.full : Noradrenaline and Acetylcholine shape Functional Connectivity organization of NREM substages: an empirical and simulation study 

* Abstract: 

Awake brain dynamics are maintained by various wake-promoting mechanisms, particularly the neuromodulators Acetylcholine (ACh) and Noradrenaline (NA), whose levels naturally decrease during the transition to sleep. The interaction between these neurotransmitters and their combined influence on brain connectivity during NREM sleep stages remains unclear. Previous models have considered the effects of these neurotransmitters, but typically in isolation or only during deep sleep. In this study, we employ a Whole Brain model to investigate how changes in brain neurochemistry during NREM sleep, specifically involving ACh and NA, affect functional brain connectivity. Using a Wilson-Cowan whole brain model informed by an empirical connectome and a heterogeneous receptivity map of neuromodulators, we explore these dynamics. Initial Functional Connectivity analysis reveals distinct connectivity changes: a decrease in Locus Coeruleus (LC) connectivity with the cortex during N2 and N3, and a decrease in Basal Forebrain (BF) connectivity with the cortex during N3. Additionally, compared to W, there is a transition to a more integrated state in N1 and a more segregated state in N3. We examine this phenomenon using a biophysical model, adjusting global coupling and local input-output slope parameters for ACh and NA, respectively. When these parameters vary heterogeneously based on BF or LC priors, the model's fit to all stages FC improves, demonstrating that the region-specific distribution of these neurotransmitters is crucial for explaining their effects on brain Functional Connectivity. This work enhances our understanding of neurotransmitters' roles in modulating sleep stages and their significant contribution to brain state transitions between different states of consciousness, both in health and disease.

* Summary:
  Analyzing average whole brain FC matrices of 15 individuals in W and NREM substages, we report a fluctuation in the integration and segregation profile across sleep stages. We fitted a model to these matrices varying the local coupling and input-output slope of each node, in a homogeneous way and also using NA and ACh proxy maps. We found a general improvement in the goodness of fit using these proxys for NA and ACh down-regulation in sleep, compared to homogeneous and shuffled-map modulation modalities.

* Steps for reproducing the results: 

1) Empirical BOLD signals were extracted using empirical/extract.py, and the corresponding timeseries are available in https://zenodo.org/records/16755776 . Empirical mean FC matrices were also generated there.
2) Run optimize_SC_Hopf.py for optimizing the interhemispheric connections in the structural connectivity matrix. The output is SC_opti_25julio.txt
3) Sweep the G and sigma parameters homogeneously in whole_sweep_both.py to generate FC matrices, and save the gof against all states (W,N1,N2,N3). This will be the baseline against which we compare goodness of fit of the "map" and "shuffle" modality of all states.
   This step was run in a computing cluster, so the code is implemented to be run in slurm using multiple cores. The output has to be collapsed to a file like output/sweep_delta_homoW_fromG0.16_sigma7.68_maps_0_0_9dic24_50iter.txt
4) Find the optimal for W and use it as a baseline for what is next (can be done in heatmaps.py). Run whole_sweep_both_maps.py for the "map" modality, i.e. with the DIST_LC_proj.npy and DIST_VAChT_feobv_hc18_aghourian.npy for NA and ACh, respectively (available in empirical/maps/). This will calculate the goodness of fit against all states using the heterogeneity maps. Collapse.
5) Use whole_sweep_both_maps.py, now with the shuffled versions of the heterogeneity maps (also available in empirical/maps/), to obtain the goodness of fit of the model considering this control modality.
6) Given the optimal parameters, integration and segregation parameters per node can be obtained in run_many_seeds.py. Given the empirical FC matrices, empirical integration and segregation profiles can also be obtained here.
7) The scripts that generate the figures were used to calculate all comparisons that are reported in the manuscript.
